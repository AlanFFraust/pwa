<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="https://cdn.icon-icons.com/icons2/618/PNG/512/Currency_Conversion_icon-icons.com_56682.png">
    <link rel="stylesheet" href="./styles.css">
    <link rel="manifest" href="./manifest.json">
    <title>Conversor de Monedas</title>
  </head>
  <body>

    <h1>Conversor de Monedas</h1>

    <label for="amount">Cantidad:</label>
    <input type="number" id="amount" placeholder="Ingrese la cantidad">

    <label for="from">De:</label>
    <select id="from">
        <option value="pesos">Pesos</option>
        <option value="dolar">Dólar</option>
    </select>

    <label for="to">A:</label>
    <select id="to">
        <option value="pesos">Pesos</option>
        <option value="dolar">Dólar</option>
    </select>

    <button onclick="realizarConversion()">Convertir</button>

    <div id="result"></div>

    <script>
        // Función para realizar la conversión
        function realizarConversion() {
            var amount = parseFloat(document.getElementById('amount').value);
            var fromCurrency = document.getElementById('from').value;
            var toCurrency = document.getElementById('to').value;

            // Llamada a la función del Service Worker para realizar la conversión
            convertirMoneda(amount, fromCurrency, toCurrency);
        }

        // Escuchar el resultado de la conversión desde el Service Worker
        navigator.serviceWorker.addEventListener('message', event => {
            if (event.data && event.data.type === 'conversionResult') {
                const result = event.data.result;

                // Mostrar el resultado en la interfaz de usuario
                document.getElementById('result').innerHTML = "Resultado: " + result + " " + document.getElementById('to').value;
            }
        });

        // Llamar a esta función cuando quieras realizar la conversión
        function convertirMoneda(amount, fromCurrency, toCurrency) {
            navigator.serviceWorker.controller.postMessage({
                type: 'convert',
                amount: amount,
                fromCurrency: fromCurrency,
                toCurrency: toCurrency
            });
        }

        // Registrar el Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js', { scope: './' });
        }
    </script>

</body>
</html>
